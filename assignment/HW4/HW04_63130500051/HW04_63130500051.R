library(dplyr)
library(readr)
library(ggplot2)

prog_book <- read_csv("E:\\Desktop\\SIT_KMUTT\\IT2_1_64\\INT214 Stat for IT\\data\\prog_book.csv")
prog_book
glimpse(prog_book)

#Changing the types of values 
prog_book$Book_title <- as.factor(prog_book$Book_title)
prog_book$Description <- as.factor(prog_book$Description)
prog_book$Type <- as.factor(prog_book$Type)
prog_book$Number_Of_Pages <- as.numeric(prog_book$Number_Of_Pages)

#1
#?????????????????????????????????????????????????????? ???????????????????????? ??????????????????????????? ????????????????????????????????????????????? rating ???????????????????????????????????? 4.5 ??????????????????
prog_book %>% select(Book_title, Description, Type) %>% filter(prog_book$Rating >= 4.5)

#2
#???????????????????????????????????? rating ?????????????????????????????????????????? 
prog_book %>% select(Book_title, Rating) %>% filter(Rating == max(Rating))
prog_book %>% filter(Rating == max(Rating))


#3
#?????????????????????????????????????????????????????????????????????????????????????????????????????????
prog_book %>% distinct(Type) #?????? 6 ??????????????????

#???????????????????????????????????????????????????????????????????????????
prog_book %>% count(Type == "Hardcover")
prog_book %>% count(Type == "Kindle Edition")
prog_book %>% count(Type == "Paperback")
prog_book %>% count(Type == "ebook")
prog_book %>% count(Type == "Boxed Set - Hardcover")
prog_book %>% count(Type == "Unknown Binding")

#4 
#10 ?????????????????????????????????????????????????????????????????????????????????????????????
toplowprice <- prog_book %>% select(Book_title, Price) %>% arrange(Price)
toplowprice <- head(toplowprice, 10) 
toplowprice

#5
#5 ??????????????????????????????????????????????????????????????? review ???????????????????????????
top_review  <- prog_book %>% select(Book_title, Reviews) %>% slice_max(Reviews, n=5)
top_review


#6
#?????????????????????????????????????????????????????????????????????????????????????????? ????????? ????????????????????? ???????????????????????????????????????????????????????????????
max_page <- prog_book %>% select(Book_title, Number_Of_Pages, Price) %>%
  filter(Number_Of_Pages == max(Number_Of_Pages))
max_page

min_page <- prog_book %>% select(Book_title, Number_Of_Pages, Price) %>%
  filter(Number_Of_Pages == min(Number_Of_Pages))
min_page


#scat_plot
scat_plot <- prog_book %>% ggplot(aes(x=Rating, y=Price))+
  geom_point(aes(color=Type))
scat_plot+geom_smooth() 

#bar_plot
bar_plot <- ggplot(prog_book,aes(x=Type)) + geom_bar()
bar_plot + ggtitle("The number of Books of each Type") +
  xlab("Type") + ylab("Number of Books") 

# Learning function from Tidyverse
prog_book %>% distinct(Type)
prog_book %>% pull(Reviews)
prog_book %>% relocate(Book_title, Rating, Reviews, Price)

#test
pie(table(prog_book$Price))
boxplot(prog_book$Price,data=prog_book)
hist(prog_book$Price)

scat_plot <- prog_book %>% ggplot(aes(x=Rating, y=Price))+
  geom_histogram(binwidth = 10)

prog_book %>% ggplot(aes(x=Rating, y=Price))+geom_bar()




